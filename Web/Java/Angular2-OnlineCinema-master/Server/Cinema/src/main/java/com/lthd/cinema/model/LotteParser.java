package com.lthd.cinema.model;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import com.lthd.cinema.model.dao.Film;
import com.lthd.cinema.model.dao.SlideShow;
import com.squareup.okhttp.FormEncodingBuilder;
import com.squareup.okhttp.Headers;
import com.squareup.okhttp.MediaType;
import com.squareup.okhttp.OkHttpClient;
import com.squareup.okhttp.Request;
import com.squareup.okhttp.RequestBody;
import com.squareup.okhttp.Response;

import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * Created by TuNam1995 on 19/05/2016.
 */
public class LotteParser extends FilmParser{ 
	
	private Map<String, String> mapping = new HashMap();
	private static final com.squareup.okhttp.MediaType x_www_form_urlencoded = com.squareup.okhttp.MediaType.parse("application/x-www-form-urlencoded");
	
    public LotteParser(String url) {
        super();
        this.url = url;
        init();
    }
    
    private void init() {
    	mapping.put("Nam Sài Gòn", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECBGQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGQtuWo4fs%2FMHLGV6%2Fzy%2B2lHxI07nQ%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKAKnvqKAAgLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBAiN%2BYVXTaaM8beZ25oNEGijWt9M&ddlCinema=8001&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Diamond", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECBWQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGQ%2F%2Fgfqfpv%2F9DzWiOt%2F1D2ByFf4yg%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKALSz4nYAgLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBNrDhMxj%2BYBmZ0Vk37pQ%2FG5C2y2G&ddlCinema=8002&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Cộng Hòa", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECBmQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGQzIEL%2Bsh9Kf0J3CVsuMngl5mnTYA%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKAKVrdvWBwLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBOogimcCRyJgGTocCrEmPuqoCgM3&ddlCinema=8008&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Cantavil", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECB2QCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGTO6GRrRRmLxyr5zw5btuhCHhIeow%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKAL1o%2B6tAgLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBHrTljo%2Fr0m1IGpQ3BS8Lh5N0nFd&ddlCinema=8009&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Phú Thọ", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECCGQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGRU63vvYAMCfFhc4uk3ZrAhP9lrsA%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKALT0quoDALwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBFAxjwUbBOZqT5XBuTOh2K6Xfgky&ddlCinema=8012&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("NowZone", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECCWQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGQSu82hpWdgCbDkixPqiM5mb8Zirg%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKAKA2s7BCgLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBAXBYTh6vbWloxQFY01xZeE95%2Fb1&ddlCinema=8024&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Gò Vấp", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECCmQCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGSav3j2jXIZ9RcyWj85ECaIjFsJhg%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKALfycrDBQLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBGy0X6ubIm0vOVu6%2BIfiMu%2BbT8WA&ddlCinema=8027&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    	mapping.put("Thủ Đức", "__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKLTI4NDgwMTIzNw9kFgICAxBkZBYGZg8QDxYGHg1EYXRhVGV4dEZpZWxkBQpjaW5lbWFOYW1lHg5EYXRhVmFsdWVGaWVsZAUKY2luZW1hQ29kZR4LXyFEYXRhQm91bmRnZBAVHhAtLUNo4buNbiBy4bqhcC0tCExhbmRtYXJrBkhhRG9uZwlUaGFuZ0xvbmcJTmFtU2FpR29uB0RpYW1vbmQHQ29uZ0hvYQhDYW50YXZpbAZQaHVUaG8HTm93Wm9uZQVHb1ZhcAZUaHVEdWMGSGFMb25nCEJhY0dpYW5nB1ZpZXRUcmkISGFpUGhvbmcITmluaEJpbmgIVGhhaUJpbmgITmhhVHJhbmcGRGFOYW5nCVBoYW5UaGlldANIdWUEVmluaAdEb25nTmFpCUJpbmhEdW9uZwdWdW5nVGF1B0JpZW5Ib2EGQ2FuVGhvDkNhblRob05pbmhLaWV1B0FuR2lhbmcVHgItMQQ4MDAzBDgwMDUEODAyNQQ4MDAxBDgwMDIEODAwOAQ4MDA5BDgwMTIEODAyNAQ4MDI3BDgwMjgEODAxNAQ4MDE3BDgwMjEEODAyMgQ4MDIzBDgwMjYEODAwNAQ4MDA3BDgwMTEEODAxMwQ4MDI5BDgwMDYEODAxMAQ4MDE1BDgwMTkEODAxNgQ4MDE4BDgwMjAUKwMeZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnFgECC2QCAQ8QDxYCHwJnZBAVBxAtLUNo4buNbiBuZ8OgeS0tCjA3LTAxLTIwMTcKMDgtMDEtMjAxNwowOS0wMS0yMDE3CjEwLTAxLTIwMTcKMTEtMDEtMjAxNwoxMi0wMS0yMDE3FQcCLTEKMjAxNy0wMS0wNwoyMDE3LTAxLTA4CjIwMTctMDEtMDkKMjAxNy0wMS0xMAoyMDE3LTAxLTExCjIwMTctMDEtMTIUKwMHZ2dnZ2dnZ2RkAgMPFgIeC18hSXRlbUNvdW50Av%2F%2F%2F%2F8PZGT4tqdASOHMW5XTgCYBWE0oxFRLdg%3D%3D&__VIEWSTATEGENERATOR=94DC7FCB&__EVENTVALIDATION=%2FwEWKAKcw96EDwLwm5jsBQLz9P6BCQLCtYkaAsK18dMBApibvYYNAsK1ocACAsK1vb0LAsK19QwCwrXB6QgCvYzbig0CmJuhqQQCmJvl3wICmJux5w8CvYyD3AICvYzH8ggCmJvtug4CmJv5lwcCmJvVzA8CmJuJ4wUCwrXl9ggCwrXZ5QYCvYzPrQQCvYy35wUCmJuN3AQCwrXNiA4CvYzz8A8CvYyfuQsCvYzv9gICvYzrFQK9jJOaCgKYm5HeAQLxreegDALGwK%2FlDQLGwIvlDQLGwIflDQLBwKvlDQLBwKflDQLBwKPlDQL6nOHPBDNOwKJJcPaSlvay6vRlqgH1gpPX&ddlCinema=8028&ddlPlayDate=yyyy-mm-dd&btnView=Xem+l%E1%BB%8Bch+chi%E1%BA%BFu");
    }

    @Override
    public void parse() throws IOException {
    	DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
    	DateFormat dateFormat2 = new SimpleDateFormat("dd/MM/yyyy");
    	for (String cine : mapping.keySet()) {
    		
    		Calendar today = Calendar.getInstance();
    		while(true) 
    		{
    		    String rawParsed = mapping.get(cine).replaceAll("yyyy-mm-dd", dateFormat.format(today.getTime()));
    		    
    		    OkHttpClient client = new OkHttpClient();
            	RequestBody body = RequestBody.create(x_www_form_urlencoded, rawParsed);
            	Request request = new Request.Builder()
        	      .url(url)
        	      .addHeader("Content-Type", "application/x-www-form-urlencoded")
        	      .post(body)
        	      .build();


        		Response response = client.newCall(request).execute();
        		if (response.code() == 302)
        			break;
        		
        		if (addShowTimes(response.body().string(), cine, dateFormat2.format(today.getTime())))
        			break;
    		    today.add(Calendar.DATE, 1);
    		}		
    	}
    }
    
    private boolean addShowTimes(String data, String cine, String date) {
    	Document doc = Jsoup.parse(data);
    	Elements elements;
    	try {
    		elements = doc.select("div[class=fancy-c]").get(0).select("li");
    	}
    	catch (Exception ex) {
    		return false;
    	}

		for (int i = 0; i < elements.size(); i++) {
			Film film = FilmManager.searchFilmByName(elements.get(i).select("div[class=bottom]").text());
    		if (film == null)
    			continue;
			List<List<String>> times = film.showTimes.get("Lotte " + cine);
			if (times == null)
				times = new ArrayList();
			
			List<String> time = new ArrayList();
			time.add(date);
			
			for (Element hour : elements.get(i).select("a[class=link-booking]"))
				time.add(hour.text());
			
			times.add(time);
			film.showTimes.put("Lotte " + cine, times);
		}
		return true;
	}

	@Override
    public void getSlideShow() throws IOException {
	
	}
}
